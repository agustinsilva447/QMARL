import copy
import numpy as np
import matplotlib.pyplot as plt

q_noise = [0.000, 0.001, 0.003, 0.010, 0.030, 0.100, 0.300, 1.000]
gamman  = [np.pi/2]
alpha1n = [0.1, 0.01, 0.001, 0.0001]
alpha2n = [1e-8]
beta1n  = [0.9]
beta2n  = [0.99]
epsilnn = [1e-8]

para    = []
for g in gamman:
    for a1 in alpha1n:
        for a2 in alpha2n:
            for b1 in beta1n:
                for b2 in beta2n:
                    for e in epsilnn:
                        para.append([g,a1,a2,b1,b2,e])

avg_rew_n0_000_2 = [9.66310966802444, 9.636718399017713, 9.657424126336995, 9.547387172529213]
far_fac_n0_000_2 = [0.9046842570678626, 0.9514204762052695, 0.9697807544480378, 0.633377167025043]
arr_rew_n0_000_2 = np.array(avg_rew_n0_000_2)
arr_fac_n0_000_2 = np.array(far_fac_n0_000_2)
avg_rew_n0_001_2 = [4.67012528629894, 4.443025402083643, 7.972603795391437, 4.871082406368538]
far_fac_n0_001_2 = [0.9946432129679512, 0.9748637015327183, 0.7282477084115159, 0.9734929550044549]
arr_rew_n0_001_2 = np.array(avg_rew_n0_001_2)
arr_fac_n0_001_2 = np.array(far_fac_n0_001_2)
avg_rew_n0_003_2 = [4.517563265817544, 3.9695502837779233, 4.113859573435007, 3.7472123670268607]
far_fac_n0_003_2 = [0.9799086555620572, 0.9154745004442427, 0.7063166236708422, 0.8426296951652626]
arr_rew_n0_003_2 = np.array(avg_rew_n0_003_2)
arr_fac_n0_003_2 = np.array(far_fac_n0_003_2)
avg_rew_n0_010_2 = [4.538869455189914, 3.587389048282963, 5.073761435540691, 1.9168670922077407]
far_fac_n0_010_2 = [0.9970631645119978, 0.936068949086059, 0.9636124957659276, 0.582995809192392]
arr_rew_n0_010_2 = np.array(avg_rew_n0_010_2)
arr_fac_n0_010_2 = np.array(far_fac_n0_010_2)
avg_rew_n0_030_2 = [4.445988544727261, 4.851143442195549, 4.917327857576416, 6.359525811990425]
far_fac_n0_030_2 = [0.9990177621837096, 0.9902977766996621, 0.9518607740184444, 0.9254958607011378]
arr_rew_n0_030_2 = np.array(avg_rew_n0_030_2)
arr_fac_n0_030_2 = np.array(far_fac_n0_030_2)
avg_rew_n0_100_2 = [4.560334322462407, 4.414253794337092, 5.019664381064091, 4.647096266111922]
far_fac_n0_100_2 = [0.9889411224358053, 0.980363517867055, 0.9977916681724589, 0.6180083915459895]
arr_rew_n0_100_2 = np.array(avg_rew_n0_100_2)
arr_fac_n0_100_2 = np.array(far_fac_n0_100_2)
avg_rew_n0_300_2 = [4.563838768895651, 4.552214277636321, 4.791845634169624, 4.209250373897452]
far_fac_n0_300_2 = [0.9968485581430011, 0.9860452558911964, 0.9912045554678839, 0.9366442991737804]
arr_rew_n0_300_2 = np.array(avg_rew_n0_300_2)
arr_fac_n0_300_2 = np.array(far_fac_n0_300_2)
avg_rew_n1_000_2 = [4.579392019683868, 4.675086466853627, 5.179787824724624, 3.2182437879511214]
far_fac_n1_000_2 = [0.9975099934299229, 0.9752663064843753, 0.988042320516374, 0.8255251417920411]
arr_rew_n1_000_2 = np.array(avg_rew_n1_000_2)
arr_fac_n1_000_2 = np.array(far_fac_n1_000_2)

avg_rew_n0_000_3 = [9.50856643294017, 9.942337503643307, 9.900715538355852, 9.58089437908374]
far_fac_n0_000_3 = [0.9019101032849145, 0.3383486296927282, 0.3877869232371146, 0.43063741216429124]
arr_rew_n0_000_3 = np.array(avg_rew_n0_000_3)
arr_fac_n0_000_3 = np.array(far_fac_n0_000_3)
avg_rew_n0_001_3 = [3.5518585150560793, 2.9694040474434464, 3.673057930055458, 4.167460837855885]
far_fac_n0_001_3 = [0.9834975757096625, 0.9241943084952916, 0.7106680192375885, 0.49892115828529293]
arr_rew_n0_001_3 = np.array(avg_rew_n0_001_3)
arr_fac_n0_001_3 = np.array(far_fac_n0_001_3)
avg_rew_n0_003_3 = [3.323422104247015, 3.342714652053811, 2.5516455368052364, 4.321518721216666]
far_fac_n0_003_3 = [0.9860790227639666, 0.9620395262222511, 0.7758941914281227, 0.6008001577947429]
arr_rew_n0_003_3 = np.array(avg_rew_n0_003_3)
arr_fac_n0_003_3 = np.array(far_fac_n0_003_3)
avg_rew_n0_010_3 = [3.329286504497625, 3.207908671349503, 2.4317192597451265, 4.28754246570101]
far_fac_n0_010_3 = [0.9902832708847662, 0.9633178754566204, 0.8321947850054607, 0.4400369834254746]
arr_rew_n0_010_3 = np.array(avg_rew_n0_010_3)
arr_fac_n0_010_3 = np.array(far_fac_n0_010_3)
avg_rew_n0_030_3 = [3.349444311837985, 3.2534181855492954, 2.445950933094115, 2.8423036602109293]
far_fac_n0_030_3 = [0.9956431226178282, 0.982479982955268, 0.925537859613567, 0.7252698388842136]
arr_rew_n0_030_3 = np.array(avg_rew_n0_030_3)
arr_fac_n0_030_3 = np.array(far_fac_n0_030_3)
avg_rew_n0_100_3 = [3.2991715318499755, 3.2371021144197987, 3.7532868034216187, 1.8590918941848582]
far_fac_n0_100_3 = [0.9947314201468006, 0.9679224933600823, 0.9730569089928652, 0.7677124909147534]
arr_rew_n0_100_3 = np.array(avg_rew_n0_100_3)
arr_fac_n0_100_3 = np.array(far_fac_n0_100_3)
avg_rew_n0_300_3 = [3.3483331979954074, 3.375299836385329, 3.5667386041267464, 3.3810917614471308]
far_fac_n0_300_3 = [0.9981377627970606, 0.9704981017899745, 0.9799578008405223, 0.9806079786638408]
arr_rew_n0_300_3 = np.array(avg_rew_n0_300_3)
arr_fac_n0_300_3 = np.array(far_fac_n0_300_3)
avg_rew_n1_000_3 = [3.3794370091350476, 3.3644993962564507, 3.7588802772272403, 3.653168129981926]
far_fac_n1_000_3 = [0.9932340645708698, 0.9871265975495683, 0.9784586030692317, 0.9853126069994311]
arr_rew_n1_000_3 = np.array(avg_rew_n1_000_3)
arr_fac_n1_000_3 = np.array(far_fac_n1_000_3)

avg_rew_n0_000_4 = [3.64028985536128, 3.7758383161892115, 3.1457602562696865, 4.1557946834070325]
far_fac_n0_000_4 = [0.8918305831617317, 0.9788354300824947, 0.8664409210786914, 0.7238067240380863]
arr_rew_n0_000_4 = np.array(avg_rew_n0_000_4)
arr_fac_n0_000_4 = np.array(far_fac_n0_000_4)
avg_rew_n0_001_4 = [2.3079242668612596, 1.7598114400800193, 2.4552646545466663, 3.023390291215122]
far_fac_n0_001_4 = [0.9650637195226714, 0.9059965894925601, 0.5585331818867324, 0.3685718547322144]
arr_rew_n0_001_4 = np.array(avg_rew_n0_001_4)
arr_fac_n0_001_4 = np.array(far_fac_n0_001_4)
avg_rew_n0_003_4 = [2.2385057766601375, 1.9840254094787815, 1.627992498781599, 2.30171776885738]
far_fac_n0_003_4 = [0.9663486198244772, 0.8537134585975173, 0.6991682853583658, 0.3211768522525888]
arr_rew_n0_003_4 = np.array(avg_rew_n0_003_4)
arr_fac_n0_003_4 = np.array(far_fac_n0_003_4)
avg_rew_n0_010_4 = [2.2328282914129005, 2.081101881692026, 1.4100247905291714, 4.5960720633071634]
far_fac_n0_010_4 = [0.9944628555608369, 0.9472815826795012, 0.8303413529542487, 0.5195590441536554]
arr_rew_n0_010_4 = np.array(avg_rew_n0_010_4)
arr_fac_n0_010_4 = np.array(far_fac_n0_010_4)
avg_rew_n0_030_4 = [2.1686535318414593, 2.2688343943375804, 2.437570137490677, 0.9270709626060653]
far_fac_n0_030_4 = [0.9765617566794073, 0.9561216004383324, 0.9075961968856471, 0.35851369971770725]
arr_rew_n0_030_4 = np.array(avg_rew_n0_030_4)
arr_fac_n0_030_4 = np.array(far_fac_n0_030_4)
avg_rew_n0_100_4 = [2.0815293092325273, 2.1156216610963385, 1.9865393823647637, 2.045510962551798]
far_fac_n0_100_4 = [0.9907655509217463, 0.9509405864845998, 0.9610941752431266, 0.7591686785335018]
arr_rew_n0_100_4 = np.array(avg_rew_n0_100_4)
arr_fac_n0_100_4 = np.array(far_fac_n0_100_4)
avg_rew_n0_300_4 = [2.0997764045618665, 1.9860386591464132, 1.924507484380004, 2.4060413147269113]
far_fac_n0_300_4 = [0.9823593813382757, 0.9753289594316074, 0.895125742911343, 0.7885684746548943]
arr_rew_n0_300_4 = np.array(avg_rew_n0_300_4)
arr_fac_n0_300_4 = np.array(far_fac_n0_300_4)
avg_rew_n1_000_4 = [2.1043392336537408, 2.0103915360450646, 2.3961230502830295, 2.819105945678693]
far_fac_n1_000_4 = [0.9971772889137916, 0.9722374494124127, 0.9329679924641502, 0.8300505879858348]
arr_rew_n1_000_4 = np.array(avg_rew_n1_000_4)
arr_fac_n1_000_4 = np.array(far_fac_n1_000_4)

avg_rew_n0_000_5 = [0.0787529350386312, 0.08889349348321722, 0.5935645151240181, 0.2057937110943332]
far_fac_n0_000_5 = [0.6891840553671872, 0.21474523204198176, 0.3230968515079344, 0.4150756964681562]
arr_rew_n0_000_5 = np.array(avg_rew_n0_000_5)
arr_fac_n0_000_5 = np.array(far_fac_n0_000_5)
avg_rew_n0_001_5 = [1.5996107439097147, 1.2429560749188104, 1.571194214063451, 1.581467558727799]
far_fac_n0_001_5 = [0.9823651143826138, 0.8050915710981963, 0.7348637676824296, 0.3787408832435948]
arr_rew_n0_001_5 = np.array(avg_rew_n0_001_5)
arr_fac_n0_001_5 = np.array(far_fac_n0_001_5)
avg_rew_n0_003_5 = [1.6975342001425355, 1.4381837661144046, 1.4751580685252847, 3.895834617569245]
far_fac_n0_003_5 = [0.9731593878537738, 0.9005861724516828, 0.8871299926474852, 0.32810301740974096]
arr_rew_n0_003_5 = np.array(avg_rew_n0_003_5)
arr_fac_n0_003_5 = np.array(far_fac_n0_003_5)
avg_rew_n0_010_5 = [1.6286004634385116, 1.4226894897761344, 1.5373044622284704, 2.1361182619515926]
far_fac_n0_010_5 = [0.9719571038966882, 0.9557231247607775, 0.7451226808790852, 0.6112089287289738]
arr_rew_n0_010_5 = np.array(avg_rew_n0_010_5)
arr_fac_n0_010_5 = np.array(far_fac_n0_010_5)
avg_rew_n0_030_5 = [1.5976920266651675, 1.2387725035582655, 1.4414860188183254, 3.221233006850101]
far_fac_n0_030_5 = [0.9866846147377174, 0.8556442983507617, 0.8614415618672013, 0.5966340831409883]
arr_rew_n0_030_5 = np.array(avg_rew_n0_030_5)
arr_fac_n0_030_5 = np.array(far_fac_n0_030_5)
avg_rew_n0_100_5 = [1.5599658985511458, 1.4594248432131138, 1.2109105933075277, 1.8146939302331901]
far_fac_n0_100_5 = [0.9907085009861045, 0.9331785938130434, 0.9129411920099265, 0.8542941881389764]
arr_rew_n0_100_5 = np.array(avg_rew_n0_100_5)
arr_fac_n0_100_5 = np.array(far_fac_n0_100_5)
avg_rew_n0_300_5 = [1.4765360901107523, 1.3915585298688244, 1.6819882491415985, 1.7579714669109805]
far_fac_n0_300_5 = [0.9949272045093823, 0.9467180373884916, 0.9133416636447641, 0.7638501977442441]
arr_rew_n0_300_5 = np.array(avg_rew_n0_300_5)
arr_fac_n0_300_5 = np.array(far_fac_n0_300_5)
avg_rew_n1_000_5 = [1.4449862204202826, 1.3965772584219867, 1.400567783394698, 1.9434317471898401]
far_fac_n1_000_5 = [0.9895451283697739, 0.9400169029191031, 0.8315346098209327, 0.7298023890064516]
arr_rew_n1_000_5 = np.array(avg_rew_n1_000_5)
arr_fac_n1_000_5 = np.array(far_fac_n1_000_5)

avg_rew_n0_000_6 = [0.40019109760604393, 0.5389022757888209, 0.47161567317667746, 0.4962389273893276]
far_fac_n0_000_6 = [0.9214315881479486, 0.860200491749001, 0.9224196887858231, 0.6398799103525326]
arr_rew_n0_000_6 = np.array(avg_rew_n0_000_6)
arr_fac_n0_000_6 = np.array(far_fac_n0_000_6)
avg_rew_n0_001_6 = [1.0517639675922332, 0.7373632402081933, 1.071750758641317, 0.5379946234559371]
far_fac_n0_001_6 = [0.9651893688627012, 0.8294262749274645, 0.605277487737624, 0.5376887156168824]
arr_rew_n0_001_6 = np.array(avg_rew_n0_001_6)
arr_fac_n0_001_6 = np.array(far_fac_n0_001_6)
avg_rew_n0_003_6 = [1.1093793407582768, 0.728513044053738, 1.401327064622361, 1.0079653872444607]
far_fac_n0_003_6 = [0.9803332541672293, 0.8964820572624472, 0.6554325076660112, 0.4041824883884735]
arr_rew_n0_003_6 = np.array(avg_rew_n0_003_6)
arr_fac_n0_003_6 = np.array(far_fac_n0_003_6)
avg_rew_n0_010_6 = [1.1810870260867883, 0.9473786308159768, 0.8320085622180619, 1.9005723693694232]
far_fac_n0_010_6 = [0.972225288523984, 0.9166376919043591, 0.9639446540880577, 0.5150789110507072]
arr_rew_n0_010_6 = np.array(avg_rew_n0_010_6)
arr_fac_n0_010_6 = np.array(far_fac_n0_010_6)
avg_rew_n0_030_6 = [1.1538059332586048, 0.8126927430681009, 1.0969351131595422, 1.5449497338547173]
far_fac_n0_030_6 = [0.9705532584197983, 0.8938745585520265, 0.8130174969579256, 0.3254276127378677]
arr_rew_n0_030_6 = np.array(avg_rew_n0_030_6)
arr_fac_n0_030_6 = np.array(far_fac_n0_030_6)
avg_rew_n0_100_6 = [1.1252993574682337, 0.8821586467965875, 1.19498197512556, 1.4915639715829763]
far_fac_n0_100_6 = [0.9762194694214166, 0.8562516087089206, 0.8076523420303247, 0.45652318153062127]
arr_rew_n0_100_6 = np.array(avg_rew_n0_100_6)
arr_fac_n0_100_6 = np.array(far_fac_n0_100_6)
avg_rew_n0_300_6 = [1.013349727726311, 0.951118202454943, 1.367260242005059, 1.3070891893240235]
far_fac_n0_300_6 = [0.982076568789813, 0.950061483779864, 0.8441215713245558, 0.6581733885652041]
arr_rew_n0_300_6 = np.array(avg_rew_n0_300_6)
arr_fac_n0_300_6 = np.array(far_fac_n0_300_6)
avg_rew_n1_000_6 = [0.9653106254394664, 0.8110060939649564, 0.9557682478905918, 0.9965104895321315]
far_fac_n1_000_6 = [0.9913857341070591, 0.9340283383220067, 0.8693079948760123, 0.6838283973085892]
arr_rew_n1_000_6 = np.array(avg_rew_n1_000_6)
arr_fac_n1_000_6 = np.array(far_fac_n1_000_6)

arr_rew = [arr_rew_n0_000_6,
           arr_rew_n0_001_6,
           arr_rew_n0_003_6,
           arr_rew_n0_010_6,
           arr_rew_n0_030_6,
           arr_rew_n0_100_6,
           arr_rew_n0_300_6,
           arr_rew_n1_000_6]
arr_fac = [arr_fac_n0_000_6,
           arr_fac_n0_001_6,
           arr_fac_n0_003_6,
           arr_fac_n0_010_6,
           arr_fac_n0_030_6,
           arr_fac_n0_100_6,
           arr_fac_n0_300_6,
           arr_fac_n1_000_6]

best_rwg = []
aver_rwg = []

for i, (l, n) in enumerate(zip(arr_rew, arr_fac)):    
    aver_rwg.append(np.mean(l))
    print("\n ---> Best rewards and fairness for quantum noise = {}".format(q_noise[i]))
    copy_rew = copy.deepcopy(l)
    sorted_array = np.sort(copy_rew)[::-1]    
    best_rwg.append(sorted_array[0])
    for rewi in sorted_array:
        id_rew = np.where(rewi == l)
        id_fac = n[id_rew[0][0]]
        hypara = para[id_rew[0][0]]
        print("Average reward = {:.6f}. Fairness factor = {:.6f}. A1 = {}. A2 = {}. B1 = {}. B2 = {}.".format(rewi, id_fac, hypara[1], hypara[2], hypara[3], hypara[4]))

bestbest = np.max(best_rwg)
id_best  = np.where(best_rwg == bestbest)
id_rew   = np.where(arr_rew[id_best[0][0]] == bestbest)
hypara = para[id_rew[0][0]]
print("\nBest average rewards = {}. Quantum noise = {}. A1 = {}. A2 = {}. B1 = {}. B2 = {}.".format(best_rwg[id_best[0][0]], q_noise[id_best[0][0]], hypara[1], hypara[2], hypara[3], hypara[4]))

fig0, axs = plt.subplots(1,2,figsize=(20,8))
axs[0].set_title("Best Reward vs Quantum Noise")
axs[0].plot(np.log(q_noise), best_rwg, marker="o")
axs[0].set_xlabel("Quantum Noise")
axs[0].set_ylabel("Best Reward")
#axs[0].set_ylim(0,10)

axs[1].set_title("Avg Reward vs Quantum Noise")
axs[1].plot(q_noise, aver_rwg, marker="o")
axs[1].set_xlabel("Quantum Noise")
axs[1].set_ylabel("Avg Reward")
#axs[1].set_ylim(0,10)
plt.show()