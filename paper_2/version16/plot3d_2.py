import copy
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import cm

eps = [1e-3, 1e-4, 1e-5, 1e-6,  1e-7,  1e-8,   1e-9]
epsiln = np.log(eps)
alp = [0.1,  0.03, 0.01, 0.003, 0.001, 0.0003, 0.0001]
alphan = np.log(alp)
alphan, epsiln = np.meshgrid(alphan, epsiln)

avgr_rew = [[9.916049534484673, 9.971479165131402, 9.968413760467982, 9.858903404662321, 9.855164520968696, 9.09212148075913, 9.9999999988412],
[9.941354411295887, 9.974667495976737, 9.983539822213812, 9.80623520032494, 9.696145907152067, 9.069921312163164, 8.786320034474546],
[9.919035873763134, 9.978300923862337, 9.989976132009982, 9.959477596166373, 9.709881588572806, 9.436113950228366, 8.979165188178007],
[9.9334513992008, 9.965799392731839, 9.986877144215715, 9.941996233714566, 9.734276620844167, 8.51763080789125, 6.5220437101306095],
[9.92868344869452, 9.971423376844019, 9.97953994318142, 9.933484887603132, 9.62647114005142, 8.302486327389555, 9.146018823927545],
[9.945405167687877, 9.970403330592577, 9.982635527765467, 9.919024529105213, 9.568049847702758, 8.578792642296348, 8.860035741774002],
[9.91992422696648, 9.963840723170525, 9.953843153610904, 9.917603185080925, 9.685817860622379, 8.884347483508243, 9.965801160494106]]
arr_rew = np.array(avgr_rew)

fair_fac = [[0.871151292617525, 0.7408981735338428, 0.8598991885644137, 0.9935938219275673, 0.5849869893148135, 0.785092154230746, 0.5000000000021938],
[0.9804933721608133, 0.9917895902634083, 0.8544171253411819, 0.9192905799547563, 0.8990811657999526, 0.8847402084708942, 0.6797257472945669],
[0.712566115696798, 0.843650028695287, 0.7953755274293103, 0.9765607767101778, 0.6236603831185682, 0.6995150386564043, 0.5878618117831352],
[0.9389360666660377, 0.8598329103086557, 0.9277912961882749, 0.8240388768775146, 0.5503154008803912, 0.5062991717761678, 0.500512297941637],
[0.6927182055620701, 0.7826093494492987, 0.9510983867527484, 0.7297337069215121, 0.8793821810835841, 0.6662654277449764, 0.927187498465779],
[0.9786280293215589, 0.8950318385244687, 0.8582351277135736, 0.5762299166489413, 0.7933271099151509, 0.772202099698734, 0.7772179277571256],
[0.7826375370712624, 0.8633193813703797, 0.808305874241068, 0.9632896335618717, 0.783696011155132, 0.8113144245750048, 0.5011452168863376]]
arr_fac = np.array(fair_fac)

copy_rew = copy.deepcopy(arr_rew)
sorted_array = np.sort(copy_rew.flatten())[::-1]
for rewi in sorted_array:
    id_rew = np.where(rewi == arr_rew)
    id_fac = arr_fac[id_rew[0][0]][id_rew[1][0]]
    best_epsil = eps[id_rew[0][0]]
    best_alpha = alp[id_rew[1][0]]
    print("Average reward = {:.6f}. Fairness factor = {:.6f}. Delta epsilon = {}. Learning rate = {}.".format(rewi, id_fac, best_epsil, best_alpha))


fig = plt.figure(figsize=plt.figaspect(0.5))
ax = fig.add_subplot(1, 2, 1, projection='3d')
surf = ax.plot_surface(alphan, epsiln, arr_rew, rstride=1, cstride=1, cmap=cm.coolwarm, linewidth=0, antialiased=False)
ax.set_zlim(0, 10)
ax = fig.add_subplot(1, 2, 2, projection='3d')
surf = ax.plot_surface(alphan, epsiln, arr_fac, rstride=1, cstride=1, cmap=cm.coolwarm, linewidth=0, antialiased=False)
ax.set_zlim(0, 1)
plt.show()