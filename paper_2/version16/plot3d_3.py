import copy
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import cm

eps = [1e-3, 1e-4, 1e-5, 1e-6,  1e-7,  1e-8,   1e-9]
epsiln = np.log(eps)
alp = [0.1,  0.03, 0.01, 0.003, 0.001, 0.0003, 0.0001]
alphan = np.log(alp)
alphan, epsiln = np.meshgrid(alphan, epsiln)

avgr_rew = [[9.834838173775868, 9.876217637883679, 9.913625862555644, 9.990647558563436, 9.992171922835562, 9.999855510175772, 9.999995834400305],
[9.762067231917845, 9.825052305878664, 9.91150066292886, 9.947486616444788, 9.996230762757156, 9.99902209102155, 9.994643762753466],
[9.863843278380712, 9.843406680842758, 9.910928659683949, 9.896171214993293, 9.991850971400401, 9.999309340264135, 9.99955319116952],
[9.79180841233238, 9.885988954163038, 9.938788680514484, 9.905296978234865, 9.964290931930686, 9.999753686815934, 9.998712836081685],
[9.81516818183563, 9.827686542657172, 9.961119520470838, 9.937638271039013, 9.964517229168159, 9.999607531007399, 9.999667531685455],
[9.856787199602993, 9.83433002786703, 9.887873092847633, 9.951258894265266, 9.969813841466678, 9.999920289497384, 9.999853431167084],
[9.81244057873399, 9.853104351739084, 9.928890243431182, 9.880406588115868, 9.99877190048634, 9.999998184434938, 9.999962111305685]]
arr_rew = np.array(avgr_rew)

fair_fac = [[0.8317118030016118, 0.9047811476484726, 0.9192012210379681, 0.3338980657894087, 0.3333768233960311, 0.3333743958972566, 0.33336564465464985],
[0.942928520171064, 0.7163504945346858, 0.6804173122162205, 0.33382049093138944, 0.3342200649556083, 0.3335044291741536, 0.3340668559010094],
[0.8017385274140246, 0.6930095175555521, 0.7197441348342705, 0.4433449248251809, 0.3345003363682335, 0.3333408179210222, 0.3333401581501683],
[0.8876031195044592, 0.6027180438681574, 0.840912927535299, 0.6487940882911976, 0.5421923159095529, 0.3347112545821834, 0.3368651008883418],
[0.9331526627547335, 0.851853716781519, 0.4354022648541756, 0.4721189092776608, 0.3344611136042841, 0.3357590445623717, 0.3389416295761284],
[0.6443759705151566, 0.8938507266878887, 0.7596492227241822, 0.6346799176024929, 0.334547466387043, 0.334878381994831, 0.3370407662363905],
[0.9497702017955615, 0.8517734889716639, 0.7520890085769978, 0.7652994004753045, 0.3342009883981585, 0.3334813682910606, 0.3338010642453439]]
arr_fac = np.array(fair_fac)

copy_rew = copy.deepcopy(arr_fac)
sorted_array = np.sort(copy_rew.flatten())[::-1]
for rewi in sorted_array:
    id_rew = np.where(rewi == arr_fac)
    id_fac = avgr_rew[id_rew[0][0]][id_rew[1][0]]
    best_epsil = eps[id_rew[0][0]]
    best_alpha = alp[id_rew[1][0]]
    print("Average reward = {:.6f}. Fairness factor = {:.6f}. Delta epsilon = {}. Learning rate = {}.".format(rewi, id_fac, best_epsil, best_alpha))


fig = plt.figure(figsize=plt.figaspect(0.5))
ax = fig.add_subplot(1, 2, 1, projection='3d')
surf = ax.plot_surface(alphan, epsiln, arr_rew, rstride=1, cstride=1, cmap=cm.coolwarm, linewidth=0, antialiased=False)
ax.set_zlim(0, 10)
ax = fig.add_subplot(1, 2, 2, projection='3d')
surf = ax.plot_surface(alphan, epsiln, arr_fac, rstride=1, cstride=1, cmap=cm.coolwarm, linewidth=0, antialiased=False)
ax.set_zlim(0, 1)
plt.show()