import numpy as np
import matplotlib.pyplot as plt

q_noise = [0, 1/1024, 1/512, 1/256, 1/128, 1/64, 1/32, 1/16, 1/8, 1/4, 1/2, 1]

Rewards_4_1  = [3.901195892090904, 3.1186166024861444, 2.4924966787266056, 1.6938334972918487, 2.444143830290242, 2.1812269258490433, 2.5666967086378767, 2.3001600101126347, 2.2417750240573597, 2.222998240430622, 2.1223629854060437, 2.169341052581887]
Fairness_4_1 = [0.7515606762494461, 0.9266752314241002, 0.8078298923011716, 0.7625771891770273, 0.7722279224993142, 0.9563632106470664, 0.8979213158668148, 0.8602274581793492, 0.7684186032981454, 0.9609913191245668, 0.9212021567896045, 0.7384692558462446]
Rewards_4_2  = [3.5875878851546865, 2.7976110274088652, 2.3704665697164815, 1.8633326774755552, 2.756115423944971, 2.0271830243596214, 2.0150233078644697, 2.114393441251815, 2.0105295103238854, 2.091908405950605, 1.9958450179834768, 2.111794491895095]
Fairness_4_2 = [0.8414538258277015, 0.8126169192748488, 0.8878683358502999, 0.7222935714160671, 0.7956445314691823, 0.837609806102961, 0.7443460446562652, 0.7221406542174095, 0.77895724749212, 0.9095441990856319, 0.8754048819184832, 0.9017388447816043]
Rewards_4_3  = [4.021973428758145, 2.1906322201677275, 2.177732123228016, 2.3606500446702174, 1.8427591036642132, 2.320529083648683, 2.2229837648075277, 2.0337540680049786, 2.340843740525652, 1.9009105013305603, 1.9562426182423724, 2.3699280007720054]
Fairness_4_3 = [0.8800295872572892, 0.8150001456362422, 0.5921314470343001, 0.797200174430522, 0.7141729058187629, 0.8064331590365557, 0.7995835884729765, 0.875380202707142, 0.9196628727386417, 0.8745560033140042, 0.9007479453700958, 0.976951640928682]
Rewards_4_4  = [4.318836265094339, 1.8085329203556135, 2.7888647128204016, 2.7984835680586966, 1.9692223999660108, 2.4898380570606284, 2.449192732970898, 2.2019192583253493, 2.5505172172206514, 2.3265808051126418, 2.130855144753266, 2.429000710809671]
Fairness_4_4 = [0.6716536619743829, 0.6640227846409339, 0.827618674375909, 0.6974606998966776, 0.8092837057831354, 0.8931830918194787, 0.839644239421424, 0.8838290834099937, 0.8687887990885592, 0.946879315853166, 0.9834613998932488, 0.9421257906392146]
Rewards_4_5  = [3.9027696009989374, 2.5171959382583826, 2.1514898468031345, 1.9835037075167583, 2.844514345806148, 2.117752229665191, 1.8898217948088973, 2.4563561022028, 2.135926110777172, 2.3042700859701863, 2.4515162503318617, 2.3837360903785414]
Fairness_4_5 = [0.6610391778509717, 0.7741990408505067, 0.8147121764757512, 0.7803570047451392, 0.6452312036610303, 0.9546568483105194, 0.9199418989079595, 0.8846296623473946, 0.9050241880687245, 0.8176393681797275, 0.9338376510371083, 0.9774632810491566]

rewa_4 = [Rewards_4_1,
          Rewards_4_2,
          Rewards_4_3,
          Rewards_4_4,
          Rewards_4_5]
rew_4 = np.mean(rewa_4, axis=0)

fair_4 = [Fairness_4_1,
          Fairness_4_2,
          Fairness_4_3,
          Fairness_4_4,
          Fairness_4_5]
fai_4 = np.mean(fair_4, axis=0)

max = 0
arg = 0
for i in rewa_4:
    if np.max(i)>max:
        max = np.max(i)
        arg = np.argmax(i)
print("Maximum average reward = {:.3f} for quantum noise with $\gamma$ = {}.".format(max,q_noise[arg]))
"""
fig0, axs = plt.subplots(1,2,figsize=(20,8))
fig0.suptitle("Reward and fairness vs quantum noise.", fontsize=16)
axs[0].set_title("Reward vs quantum noise")
axs[0].plot(q_noise, rew_4,"o-")
axs[0].set_xlabel("Quantum noise")
axs[0].set_ylabel("Average reward")
axs[1].set_title("Fairness vs quantum noise")
axs[1].plot(q_noise, fai_4,"o-")
axs[1].set_xlabel("Average Fairness")
axs[1].set_ylabel("Quantum noise")
plt.show()
"""
plt.title("Reward vs quantum noise (4 players)")
plt.plot(q_noise, rew_4, "o-", label = "noisy")
plt.axhline(y = rew_4[0], color = 'r', linestyle = 'dashed', label = "noiseless")
plt.xlabel("Quantum noise")
plt.ylabel("Average reward")
plt.legend(loc="upper right")
plt.show()